{
  "version": 3,
  "sources": ["alert.js", "login.js", "mapbox.js", "updateSettings.js", "stripe.js", "index.js"],
  "sourcesContent": ["/* eslint-disable */\r\nconst hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\nexport const showAlert = (type, message) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${message}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n", "/* eslint-disable */\r\n// console.log('Hello from login.js');\r\n\r\nimport { showAlert } from './alert';\r\nexport async function login(email, password) {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n    if ((res.data.status = 'success')) {\r\n      showAlert('success', 'Logged in successfully!');\r\n      window.location.assign('/');\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n}\r\nexport async function logout() {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: 'http://localhost:3000/api/v1/users/logout',\r\n    });\r\n    if (res.data.status === 'success') location.reload(true);\r\n  } catch (err) {\r\n    // console.log(err.response);\r\n    showAlert('error', 'Error logging out! Try again.');\r\n  }\r\n}\r\n", "/* eslint-disable */\r\n// console.log('hello from mapbox.js');\r\nexport const displayMap = (locations) => {\r\n  // const locations = JSON.parse(\r\n  //   document.getElementById('map').dataset.locations,\r\n  // );\r\n\r\n  var map = L.map('map', { zoomControl: false });\r\n\r\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution:\r\n      '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n  }).addTo(map);\r\n\r\n  const points = [];\r\n  locations.forEach((loc) => {\r\n    points.push([loc.coordinates[1], loc.coordinates[0]]);\r\n    L.marker([loc.coordinates[1], loc.coordinates[0]])\r\n      .addTo(map)\r\n      .bindPopup(`<p>Day ${loc.day}: ${loc.description}</p>`, {\r\n        autoClose: false,\r\n      })\r\n      .openPopup();\r\n  });\r\n\r\n  const bounds = L.latLngBounds(points).pad(0.5);\r\n  map.fitBounds(bounds);\r\n\r\n  map.scrollWheelZoom.disable();\r\n  map.touchZoom.disable();\r\n};\r\n", "import { showAlert } from './alert';\r\n\r\nexport async function updateSettings(data, type) {\r\n  const url =\r\n    type === 'password'\r\n      ? '/api/v1/users/updatePassword'\r\n      : '/api/v1/users/updateMe';\r\n  try {\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data,\r\n    });\r\n    if (res.data.status === 'success') {\r\n      showAlert(\r\n        'success',\r\n        `${type == 'password' ? 'password' : 'data'} updated successfully!`,\r\n      );\r\n      window.setTimeout(() => {\r\n        location.reload(true);\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n}\r\n", "import { showAlert } from './alert';\r\nconst stripe = Stripe(\r\n  'pk_test_51QSmqpHFFmsZw6zA5oZNmEgzaMaPhxAZx50Tg3QXCuWvzb7fXx1FIvoLw8fDpXwm1DofUHBxvVI58BYI19TdjvCm00bBEIR84D',\r\n);\r\n\r\nexport async function bookTour(tourId) {\r\n  try {\r\n    const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch (err) {\r\n    showAlert('error', err);\r\n  }\r\n}\r\n", "import { login, logout } from './login';\r\nimport { displayMap } from './mapbox';\r\nimport { updateSettings } from './updateSettings';\r\nimport { bookTour } from './stripe';\r\n// console.log('hello from the client side');\r\n\r\nconst spinner = document.getElementById('loading-spinner');\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  // console.log('DOM fully loaded and parsed');\r\n  const showSpinner = () => spinner.classList.remove('hidden');\r\n  showSpinner();\r\n  // console.log('spinner');\r\n});\r\nconst hideSpinner = () => spinner.classList.add('hidden');\r\nwindow.addEventListener('load', () => {\r\n  setTimeout(hideSpinner, 100);\r\n  // hideSpinner();\r\n  // console.log('hide spinner');\r\n});\r\n\r\nconst mapBox = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form--login');\r\nconst updateUserDataForm = document.querySelector('.form-user-data');\r\nconst updateUserPasswordForm = document.querySelector('.form-user-settings');\r\nconst logoutBtn = document.querySelector('.nav__el--logout');\r\nconst bookBtn = document.getElementById('book-tour');\r\n\r\n// map\r\nif (mapBox) {\r\n  const locations = JSON.parse(\r\n    document.getElementById('map').dataset.locations,\r\n  );\r\n  // console.log('dislaping');\r\n  displayMap(locations);\r\n}\r\n\r\n// login\r\nif (loginForm) {\r\n  document.querySelector('.form').addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (logoutBtn) logoutBtn.addEventListener('click', logout);\r\n\r\nif (updateUserDataForm) {\r\n  updateUserDataForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n\r\n    // const email = document.getElementById('email').value;\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', document.getElementById('photo').files[0]);\r\n    // console.log(name, email);\r\n    // updateSettings({ name, email });\r\n    // console.log(form);\r\n    // console.log(form.get('photo'));\r\n    updateSettings(form, 'data');\r\n  });\r\n}\r\nif (updateUserPasswordForm) {\r\n  updateUserPasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    const currentPassword = document.getElementById('password-current').value;\r\n    const newPassword = document.getElementById('password').value;\r\n    const confirmNewPassword =\r\n      document.getElementById('password-confirm').value;\r\n    document.querySelector('.form-user-settings .btn').innerHTML =\r\n      'loading....';\r\n\r\n    await updateSettings(\r\n      { currentPassword, newPassword, confirmNewPassword },\r\n      'password',\r\n    );\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n    document.querySelector('.form-user-settings .btn').innerHTML =\r\n      'save password';\r\n  });\r\n}\r\n\r\nif (bookBtn) {\r\n  bookBtn.addEventListener('click', (e) => {\r\n    e.target.textContent = 'processing...';\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n  });\r\n}\r\n"],
  "mappings": "MACA,IAAMA,EAAY,IAAM,CACtB,IAAMC,EAAK,SAAS,cAAc,QAAQ,EACtCA,GAAIA,EAAG,cAAc,YAAYA,CAAE,CACzC,EACaC,EAAY,CAACC,EAAMC,IAAY,CAC1CJ,EAAU,EACV,IAAMK,EAAS,4BAA4BF,CAAI,KAAKC,CAAO,SAC3D,SAAS,cAAc,MAAM,EAAE,mBAAmB,aAAcC,CAAM,EACtE,OAAO,WAAWL,EAAW,GAAI,CACnC,ECNA,eAAsBM,EAAMC,EAAOC,EAAU,CAC3C,GAAI,CACF,IAAMC,EAAM,MAAM,MAAM,CACtB,OAAQ,OACR,IAAK,sBACL,KAAM,CACJ,MAAAF,EACA,SAAAC,CACF,CACF,CAAC,GACIC,EAAI,KAAK,OAAS,aACrBC,EAAU,UAAW,yBAAyB,EAC9C,OAAO,SAAS,OAAO,GAAG,EAE9B,OAASC,EAAK,CACZD,EAAU,QAASC,EAAI,SAAS,KAAK,OAAO,CAC9C,CACF,CACA,eAAsBC,GAAS,CAC7B,GAAI,EACU,MAAM,MAAM,CACtB,OAAQ,MACR,IAAK,2CACP,CAAC,GACO,KAAK,SAAW,WAAW,SAAS,OAAO,EAAI,CACzD,MAAc,CAEZF,EAAU,QAAS,+BAA+B,CACpD,CACF,CC/BO,IAAMG,EAAcC,GAAc,CAKvC,IAAIC,EAAM,EAAE,IAAI,MAAO,CAAE,YAAa,EAAM,CAAC,EAE7C,EAAE,UAAU,qDAAsD,CAChE,YACE,yFACJ,CAAC,EAAE,MAAMA,CAAG,EAEZ,IAAMC,EAAS,CAAC,EAChBF,EAAU,QAASG,GAAQ,CACzBD,EAAO,KAAK,CAACC,EAAI,YAAY,CAAC,EAAGA,EAAI,YAAY,CAAC,CAAC,CAAC,EACpD,EAAE,OAAO,CAACA,EAAI,YAAY,CAAC,EAAGA,EAAI,YAAY,CAAC,CAAC,CAAC,EAC9C,MAAMF,CAAG,EACT,UAAU,UAAUE,EAAI,GAAG,KAAKA,EAAI,WAAW,OAAQ,CACtD,UAAW,EACb,CAAC,EACA,UAAU,CACf,CAAC,EAED,IAAMC,EAAS,EAAE,aAAaF,CAAM,EAAE,IAAI,EAAG,EAC7CD,EAAI,UAAUG,CAAM,EAEpBH,EAAI,gBAAgB,QAAQ,EAC5BA,EAAI,UAAU,QAAQ,CACxB,EC5BA,eAAsBI,EAAeC,EAAMC,EAAM,CAC/C,IAAMC,EACJD,IAAS,WACL,+BACA,yBACN,GAAI,EACU,MAAM,MAAM,CACtB,OAAQ,QACR,IAAAC,EACA,KAAAF,CACF,CAAC,GACO,KAAK,SAAW,YACtBG,EACE,UACA,GAAGF,GAAQ,WAAa,WAAa,MAAM,wBAC7C,EACA,OAAO,WAAW,IAAM,CACtB,SAAS,OAAO,EAAI,CACtB,EAAG,IAAI,EAEX,OAASG,EAAK,CACZD,EAAU,QAASC,EAAI,SAAS,KAAK,OAAO,CAC9C,CACF,CCxBA,IAAMC,EAAS,OACb,6GACF,EAEA,eAAsBC,EAASC,EAAQ,CACrC,GAAI,CACF,IAAMC,EAAU,MAAM,MAAM,qCAAqCD,CAAM,EAAE,EACzE,MAAMF,EAAO,mBAAmB,CAC9B,UAAWG,EAAQ,KAAK,QAAQ,EAClC,CAAC,CACH,OAASC,EAAK,CACZC,EAAU,QAASD,CAAG,CACxB,CACF,CCRA,IAAME,EAAU,SAAS,eAAe,iBAAiB,EACzD,SAAS,iBAAiB,mBAAoB,IAAM,CAExBA,EAAQ,UAAU,OAAO,QAAQ,CAG7D,CAAC,EACD,IAAMC,EAAc,IAAMD,EAAQ,UAAU,IAAI,QAAQ,EACxD,OAAO,iBAAiB,OAAQ,IAAM,CACpC,WAAWC,EAAa,GAAG,CAG7B,CAAC,EAED,IAAMC,EAAS,SAAS,eAAe,KAAK,EACtCC,EAAY,SAAS,cAAc,cAAc,EACjDC,EAAqB,SAAS,cAAc,iBAAiB,EAC7DC,EAAyB,SAAS,cAAc,qBAAqB,EACrEC,EAAY,SAAS,cAAc,kBAAkB,EACrDC,EAAU,SAAS,eAAe,WAAW,EAGnD,GAAIL,EAAQ,CACV,IAAMM,EAAY,KAAK,MACrB,SAAS,eAAe,KAAK,EAAE,QAAQ,SACzC,EAEAC,EAAWD,CAAS,CACtB,CAGIL,GACF,SAAS,cAAc,OAAO,EAAE,iBAAiB,SAAW,GAAM,CAChE,EAAE,eAAe,EACjB,IAAMO,EAAQ,SAAS,eAAe,OAAO,EAAE,MACzCC,EAAW,SAAS,eAAe,UAAU,EAAE,MACrDC,EAAMF,EAAOC,CAAQ,CACvB,CAAC,EAGCL,GAAWA,EAAU,iBAAiB,QAASO,CAAM,EAErDT,GACFA,EAAmB,iBAAiB,SAAW,GAAM,CACnD,EAAE,eAAe,EACjB,IAAMU,EAAO,IAAI,SAGjBA,EAAK,OAAO,OAAQ,SAAS,eAAe,MAAM,EAAE,KAAK,EACzDA,EAAK,OAAO,QAAS,SAAS,eAAe,OAAO,EAAE,KAAK,EAC3DA,EAAK,OAAO,QAAS,SAAS,eAAe,OAAO,EAAE,MAAM,CAAC,CAAC,EAK9DC,EAAeD,EAAM,MAAM,CAC7B,CAAC,EAECT,GACFA,EAAuB,iBAAiB,SAAU,MAAO,GAAM,CAC7D,EAAE,eAAe,EACjB,IAAMW,EAAkB,SAAS,eAAe,kBAAkB,EAAE,MAC9DC,EAAc,SAAS,eAAe,UAAU,EAAE,MAClDC,EACJ,SAAS,eAAe,kBAAkB,EAAE,MAC9C,SAAS,cAAc,0BAA0B,EAAE,UACjD,cAEF,MAAMH,EACJ,CAAE,gBAAAC,EAAiB,YAAAC,EAAa,mBAAAC,CAAmB,EACnD,UACF,EACA,SAAS,eAAe,kBAAkB,EAAE,MAAQ,GACpD,SAAS,eAAe,UAAU,EAAE,MAAQ,GAC5C,SAAS,eAAe,kBAAkB,EAAE,MAAQ,GACpD,SAAS,cAAc,0BAA0B,EAAE,UACjD,eACJ,CAAC,EAGCX,GACFA,EAAQ,iBAAiB,QAAU,GAAM,CACvC,EAAE,OAAO,YAAc,gBACvB,GAAM,CAAE,OAAAY,CAAO,EAAI,EAAE,OAAO,QAC5BC,EAASD,CAAM,CACjB,CAAC",
  "names": ["hideAlert", "el", "showAlert", "type", "message", "markup", "login", "email", "password", "res", "showAlert", "err", "logout", "displayMap", "locations", "map", "points", "loc", "bounds", "updateSettings", "data", "type", "url", "showAlert", "err", "stripe", "bookTour", "tourId", "session", "err", "showAlert", "spinner", "hideSpinner", "mapBox", "loginForm", "updateUserDataForm", "updateUserPasswordForm", "logoutBtn", "bookBtn", "locations", "displayMap", "email", "password", "login", "logout", "form", "updateSettings", "currentPassword", "newPassword", "confirmNewPassword", "tourId", "bookTour"]
}
